# ğŸ“– ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš© - 2022.01.13

- ë¦¬ë•ìŠ¤
- í…ŒìŠ¤íŠ¸

## ğŸ“ ë¦¬ë•ìŠ¤ ì—†ì´ ë¦¬ì•¡íŠ¸ êµ¬í˜„ :: props drilling

```jsx
import { useState } from "react";
import "./App.css";

function App() {
  const [value, setValue] = useState(0);
  return (
    <div>
      <h1>Root</h1>
      {value}
      <div id="container">
        <Left1 number={value}></Left1>
        <Right1
          onIncrease={() => {
            setValue(value + 1);
          }}
        ></Right1>
      </div>
    </div>
  );
}

function Left1(props) {
  return (
    <div>
      <h2>Left1 : {props.number}</h2>
      <Left2 number={props.number}></Left2>
    </div>
  );
}
function Left2(props) {
  return (
    <div>
      <h3>Left2 : {props.number}</h3>
      <Left3 number={props.number}></Left3>
    </div>
  );
}
function Left3(props) {
  return (
    <div>
      <h4>Left3 : {props.number}</h4>
      <Left4 number={props.number}></Left4>
    </div>
  );
}
function Left4(props) {
  return (
    <div>
      <h5>Left4 : {props.number}</h5>
    </div>
  );
}

function Right1(props) {
  return (
    <div>
      <h2>Right1</h2>
      <Right2
        onIncrease={() => {
          props.onIncrease();
        }}
      ></Right2>
    </div>
  );
}
function Right2(props) {
  return (
    <div>
      <h3>Right2</h3>
      <Right3
        onIncrease={() => {
          props.onIncrease();
        }}
      ></Right3>
    </div>
  );
}
function Right3(props) {
  return (
    <div>
      <h4>Right3</h4>
      <Right4
        onIncrease={() => {
          props.onIncrease();
        }}
      ></Right4>
    </div>
  );
}
function Right4(props) {
  return (
    <div>
      <h5>Right4</h5>
      <input
        type="button"
        value="+"
        onClick={() => {
          props.onIncrease();
        }}
      ></input>
    </div>
  );
}

export default App;
```

## ğŸ“ ë¦¬ë•ìŠ¤ë¡œ êµ¬í˜„

- `npm install redux react-redux`
- ProviderëŠ” Provider í•˜ìœ„ì—ì„œ ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•  ê±°ë‹¤ ë¼ëŠ” ë§ì´ë‹¤.
- useSelectorëŠ” í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ë°›ëŠ”ë‹¤.

**ğŸ›  index.js**

```jsx
import React from "react";
import ReactDOM from "react-dom";
import "./index.css";
import App from "./App";
import reportWebVitals from "./reportWebVitals";
import { BrowserRouter } from "react-router-dom";
import { createStore } from "redux";
import { Provider, useDispatch, useSelector } from "react-redux";
function reducer(oldState, action) {
  if (oldState === undefined) {
    return {
      mode: "WELCOME",
      topics: [
        { id: 1, title: "html", body: "html is .." },
        { id: 2, title: "css", body: "css is .." },
      ],
      nextId: 3,
    };
  }
  const newState = { ...oldState };
  if (action.type === "CHANGE_MODE") {
    newState.mode = action.mode;
  } else if (action.type === "CHANGE_ID") {
    newState.id = action.id;
  } else if (action.type === "CREATE") {
    const newTopics = [...newState.topics];
    newTopics.push({
      id: newState.nextId,
      title: action.title,
      body: action.body,
    });
    newState.topics = newTopics;
  } else if (action.type === "UPDATE") {
    const newTopics = [...newState.topics];
    for (let i = 0; i < newTopics.length; i++) {
      let t = newTopics[i];
      if (t.id === action.id) {
        t.title = action.title;
        t.body = action.body;
      }
    }
    newState.topics = newTopics;
  } else if (action.type === "DELETE") {
    let newTopics = [];
    for (let i = 0; i < newState.topics.length; i++) {
      let t = newState.topics[i];
      if (t.id !== action.id) {
        newTopics.push(t);
      }
    }
    newState.topics = newTopics;
  } else if (action.type === "INCREASE_NEXT_ID") {
    newState.nextId++;
  }

  return newState;
}
const store = createStore(
  reducer,
  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()
);

ReactDOM.render(
  <React.StrictMode>
    <BrowserRouter>
      <Provider store={store}>
        <App />
      </Provider>
    </BrowserRouter>
  </React.StrictMode>,
  document.getElementById("root")
);

// If you want to start measuring performance in your app, pass a function
// to log results (for example: reportWebVitals(console.log))
// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals
reportWebVitals();
```

**ğŸ›  App.js**

```jsx
import "./App.css";
import { useState } from "react";
import { Link, Routes, Route, useParams, useNavigate } from "react-router-dom";
import { Provider, useDispatch, useSelector } from "react-redux";

function Header(props) {
  return (
    <header>
      <h1>
        <Link to="/">{props.title}</Link>
      </h1>
    </header>
  );
}
function Nav(props) {
  let lis = [];
  for (let i = 0; i < props.data.length; i = i + 1) {
    let d = props.data[i];
    lis.push(
      <li key={d.id}>
        <Link to={"/read/" + d.id}>{d.title}</Link>
      </li>
    );
  }
  return (
    <nav>
      <ol>{lis}</ol>
    </nav>
  );
}
function Article({ title, body }) {
  console.log("Article");
  return (
    <article>
      <h2>{title}</h2>
      {body}
    </article>
  );
}
function Create(props) {
  function submitHandler(evt) {
    evt.preventDefault();
    let title = evt.target.title.value;
    let body = evt.target.body.value;
    props.onSubmit(title, body);
    console.log(title);
  }
  return (
    <article>
      <h2>Create</h2>
      <form onSubmit={submitHandler}>
        <p>
          <input type="text" name="title" placeholder="title" />
        </p>
        <p>
          <textarea name="body" placeholder="body"></textarea>
        </p>
        <p>
          <input type="submit" value="create" />
        </p>
      </form>
    </article>
  );
}
function Update(props) {
  const params = useParams();
  const id = Number(params.id);
  const topics = props.topics;
  let _title = null;
  let _body = null;
  for (let i = 0; i < topics.length; i++) {
    if (topics[i].id === id) {
      _title = topics[i].title;
      _body = topics[i].body;
    }
  }
  const [title, setTitle] = useState(_title);
  const [body, setBody] = useState(_body);
  function submitHandler(evt) {
    evt.preventDefault();
    let title = evt.target.title.value;
    let body = evt.target.body.value;
    props.onSubmit(id, title, body);
    console.log(title);
  }
  return (
    <article>
      <h2>Update</h2>
      <form onSubmit={submitHandler}>
        <p>
          <input
            type="text"
            name="title"
            placeholder="title"
            value={title}
            onChange={(evt) => setTitle(evt.target.value)}
          />
        </p>
        <p>
          <textarea
            name="body"
            placeholder="body"
            value={body}
            onChange={(evt) => setBody(evt.target.value)}
          ></textarea>
        </p>
        <p>
          <input type="submit" value="update" />
        </p>
      </form>
    </article>
  );
}
function App() {
  console.log("App");
  const [mode, setMode] = useState("WELCOME");
  const [id, setId] = useState(null);
  const navigate = useNavigate();
  console.log("id", id);
  // const [nextId, setNextId] = useState(4);
  const nextId = useSelector((state) => state.nextId);
  // const [topics, setTopics] = useState([
  //   {id:1, title:'html', body:'html is ...'},
  //   {id:2, title:'css', body:'css is ...'},
  //   {id:3, title:'js', body:'js is ...'}
  // ]);
  const topics = useSelector((state) => state.topics);
  const dispatch = useDispatch();
  function changeModeHandler(id) {
    // let newTopics = [];
    // for(let i=0; i<topics.length; i++){
    //   if(topics[i].id !== id){
    //     newTopics.push(topics[i]);
    //   }
    // }
    // setTopics(newTopics); todo
    dispatch({ type: "DELETE", id: id });
    navigate("/");
    return;
  }

  return (
    <>
      <Header title="WEB" onChangeMode={changeModeHandler} />
      <Nav data={topics} onChangeMode={changeModeHandler} />
      <Routes>
        <Route
          path="/"
          element={<Article title="Welcome" body="Hello, React!" />}
        ></Route>
        <Route path="/read/:id" element={<Read topics={topics}></Read>}></Route>
        <Route
          path="/create"
          element={
            <Create
              onSubmit={(_title, _body) => {
                // let newTopic = {id:nextId, title:_title, body:_body}
                // let newTopics = [...topics];
                // newTopics.push(newTopic);
                // setTopics(newTopics); todo
                // setMode('READ');
                // setId(nextId);
                dispatch({ type: "CREATE", title: _title, body: _body });
                navigate("/read/" + nextId);
                // setNextId(nextId+1);
                dispatch({ type: "INCREASE_NEXT_ID" });
              }}
            ></Create>
          }
        ></Route>
        <Route
          path="/update/:id"
          element={
            <Update
              topics={topics}
              onSubmit={(id, title, body) => {
                // let newTopics = [...topics];
                // for(let i=0; i<newTopics.length; i++){
                //   if(newTopics[i].id === id){
                //     newTopics[i].title = title;
                //     newTopics[i].body = body;
                //   }
                // }
                // setTopics(newTopics); todo
                dispatch({ type: "UPDATE", id: id, title: title, body: body });
                navigate("/read/" + id);
              }}
            ></Update>
          }
        ></Route>
      </Routes>

      <Routes>
        <Route path="/" element={<Control />}></Route>
        <Route
          path="/read/:id"
          element={<Control onDelete={changeModeHandler} />}
        ></Route>
      </Routes>
    </>
  );
}
function Read(props) {
  const params = useParams();
  const id = Number(params.id);
  const topics = props.topics;
  let title = null;
  let body = null;
  for (let i = 0; i < topics.length; i++) {
    if (topics[i].id === id) {
      title = topics[i].title;
      body = topics[i].body;
    }
  }
  return <Article title={title} body={body} />;
}
function Control(props) {
  const params = useParams();
  const selectedId = Number(params.id);
  let contextUI = null;
  if (selectedId > 0) {
    contextUI = (
      <>
        <li>
          <Link to={"/update/" + selectedId}>update</Link>
        </li>
        <li>
          <form
            onSubmit={(evt) => {
              evt.preventDefault();
              props.onDelete(selectedId);
            }}
          >
            <input type="submit" value="delete" />
          </form>
        </li>
      </>
    );
  }
  return (
    <ul>
      <li>
        <Link to="/create">create</Link>
      </li>
      {contextUI}
    </ul>
  );
}
export default App;
```

## ğŸ“ í…ŒìŠ¤íŠ¸

- Test Driven Development : TDD
- ìš”ì¦˜ì€ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤.
- ìƒì‚°ì„±ì— ì €í•˜ê°€ ì˜¬ ìˆ˜ ìˆì§€ë§Œ ê²¬ê³ í•˜ê³  íƒ„íƒ„í•œ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.
- Unit test
  - í•˜ë‚˜ì˜ ëª¨ë“ˆì„ ê¸°ì¤€ìœ¼ë¡œ ë…ë¦½ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ê°€ì¥ ì‘ì€ ë‹¨ìœ„ì˜ í…ŒìŠ¤íŠ¸ â†’ React Component
  - ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ ê¸°ëŠ¥ì´ í•˜ë‚˜ ìˆë‹¤ë©´ ê·¸ ê¸°ëŠ¥ì— ëŒ€ì‘í•˜ëŠ” í…ŒìŠ¤íŠ¸ í•˜ë‚˜ë¥¼ ë§Œë“¤ê²Œ ëœë‹¤.
- Integration Test
  - ì „ì²´ í…ŒìŠ¤íŠ¸
  - í˜¸í™˜ì„±ì„ ìœ„í•´ì„œ í•˜ëŠ” í…ŒìŠ¤íŠ¸

## ğŸ’¡ ì˜¤ëŠ˜ ê¹¨ë‹¬ì€ ê²ƒ

- ì‹¤ì‹œê°„ ìˆ˜ì—…, ì˜¨ë¼ì¸ ìˆ˜ì—…, ë¬¸ì œ ë“± ë²„ì „ì´ ë‹¤ë¥´ë‹¤ ë³´ë‹ˆ ë„ˆë¬´ í—·ê°ˆë¦°ë‹¤. í•™ìŠµì€ í•¨ìˆ˜í˜•ìœ¼ë¡œ ë°°ìš°ë‹¤ê°€ ë¬¸ì œëŠ” í´ë˜ìŠ¤í˜•ìœ¼ë¡œ ë‚˜ì˜¤ê³ ...
- í…ŒìŠ¤íŒ…ì€ ì¬ë°Œìœ¼ë©´ì„œë„ ì–´ë ¤ì›Œ ë³´ì¸ë‹¤.

## ğŸ“Œ ì°¸ê³ 

- [[Redux] ë¦¬ë•ìŠ¤ë¥¼ êµ¬ì„±í•˜ëŠ” 5ê°œì˜ í•µì‹¬ Action, Reducer, Store, Dispatch, Subscribe](https://wonit.tistory.com/344)
