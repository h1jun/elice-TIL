# ğŸ“– ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš© - 2022.02.10

- ê·¸ë˜í”„ í˜ì´ì§€ ìµœì í™” ì‘ì—…
- suspense ê³µë¶€

## ğŸ“ ìµœì í™” ì‘ì—… :: React.memo, useCallback

![before](https://user-images.githubusercontent.com/81283255/153931859-04943846-91f9-490c-b7ae-f8a2f8bf3782.gif)

- íŒŒì´ ì°¨íŠ¸ëŠ” ë‹¬ë ¥ì— ìƒê´€ì—†ì´ ëª¨ë“  ê¸°ê°„ì˜ ëª¨ë“  ë ˆí¬ì˜ ì–¸ì–´ ì‚¬ìš© ë¹„ìœ¨ì„ ë³´ì—¬ì£¼ëŠ” ì»´í¬ë„ŒíŠ¸ë¼ì„œ ë³€ê²½ë  í•„ìš”ê°€ ì—†ë‹¤.

```jsx
import React from "react";
import { PieChart, Pie, Sector, Cell } from "recharts";
import githubLangColors from "./github-lang-colors.json";
import * as PieCharts from "./style";

PieChartComponent.defaultProps = {
  codeRatioArray: [
    { name: "JavaScript", value: 44.53 },
    { name: "HTML", value: 35.57 },
    { name: "CSS", value: 13.27 },
    { name: "TypeScript", value: 6.64 },
  ],
};

function PieChartComponent({ codeRatioArray }) {
  const langColor = githubLangColors;
  const COLORS = codeRatioArray.map((it) => {
    const langName = it.name;
    return langColor[langName];
  });

  return (
    <PieCharts.Container>
      <PieCharts.Wrapper>
        <PieCharts.Heading>
          <PieCharts.Title>ì‚¬ìš© ì–¸ì–´ ë¹„ìœ¨</PieCharts.Title>
          <PieCharts.Description>ì „ì²´ ë ˆí¬ ê¸°ì¤€</PieCharts.Description>
        </PieCharts.Heading>
        <PieCharts.RatioWrapper>
          {codeRatioArray &&
            codeRatioArray.map((it, idx) => (
              <PieCharts.LangColorBoxWrapper key={`${it.name}-${it.value}`}>
                <PieCharts.LangColorBox idx={COLORS[idx]} />
                <div>
                  <PieCharts.LangText>{it.value}%</PieCharts.LangText>
                  <PieCharts.LangText>{it.name}</PieCharts.LangText>
                </div>
              </PieCharts.LangColorBoxWrapper>
            ))}
        </PieCharts.RatioWrapper>
      </PieCharts.Wrapper>

      <PieCharts.PieWrapper>
        <PieChart width={200} height={200}>
          <Pie
            data={codeRatioArray}
            cx="50%"
            cy="50%"
            innerRadius={40}
            outerRadius={70}
            fill="#8884d8"
            dataKey="value"
            isAnimationActive={false}
          >
            {codeRatioArray.map((entry, index) => (
              <Cell
                key={`cell-${index}`}
                fill={COLORS[index % COLORS.length]}
              />
            ))}
          </Pie>
        </PieChart>
      </PieCharts.PieWrapper>
    </PieCharts.Container>
  );
}

export default React.memo(PieChartComponent);
```

- React.memoë¥¼ ì‚¬ìš©í•˜ì—¬ ìµœì í™”

![middle](https://user-images.githubusercontent.com/81283255/153931897-03426953-7a10-413a-8efc-b711f5631d7b.gif)

- ê·¼ë° ì›”ê°„ ì—°ê°„ ë²„íŠ¼ë„ ë°”ë€” í•„ìš”ê°€ ì—†ëŠ”ë° ë°”ë€Œê³  ìˆë‹¤.

```jsx
import React, { useCallback, useState } from "react";
import { Container } from "@/components/Container/style";
import { DateController } from "@/components/DateController";
import { LineGraph } from "./LineGraph";
import MonthYearBtn from "./MonthYearBtn";
import PieChartComponent from "./PieChart";
import { DateControllerWrapper } from "./style";
export function Graph() {
  const monthButton = true;
  const yearButton = false;
  const toDay = new Date();
  const [date, setDate] = useState(toDay);
  const clickLeft = () => {
    if (date.getFullYear() - 2000 <= 0) return;
    changeDate(-1);
  };
  const clickRight = () => {
    if (toDay.getFullYear() - date.getFullYear() <= 0) return;
    changeDate(1);
  };

  const changeDate = (value) => {
    let newDate = new Date(date.getFullYear() + value, date.getMonth());
    setDate(newDate);
  };

  const goToday = () => {
    setDate(toDay);
  };
  const [clickButtonColor, setClickButtonColor] = useState(true);
  const [checkMonth, setCheckMonth] = useState(false);
  const [graphTitle, setGraphTitle] = useState("ì›”ê°„");

  const handleMonthBtn = () => {
    if (monthButton) {
      setClickButtonColor(monthButton);
      setCheckMonth(false);
      setGraphTitle(checkMonth ? "ì›”ê°„" : "ë…„ê°„");
    }
  };
  const handlYearBtn = () => {
    if (!yearButton) {
      setClickButtonColor(!monthButton);
      setCheckMonth(true);
      setGraphTitle(checkMonth ? "ì›”ê°„" : "ë…„ê°„");
    }
  };

  return (
    <Container>
      <DateControllerWrapper>
        {!checkMonth && (
          <DateController
            date={date}
            clickLeft={clickLeft}
            clickRight={clickRight}
            goToday={goToday}
            month={false}
          />
        )}
      </DateControllerWrapper>

      <MonthYearBtn
        isClick={clickButtonColor}
        handlYearBtn={handlYearBtn}
        handleMonthBtn={handleMonthBtn}
      />
      <LineGraph graphTitle={graphTitle} />
      <PieChartComponent />
    </Container>
  );
}
```

- `<MonthYearBtn>` ì»´í¬ë„ŒíŠ¸ì— ë„˜ê²¨ì£¼ê³  ìˆëŠ” handlYearBtn, handleMonthBtn ìƒíƒœê°€ ë³€ê²½ë˜ì–´ ìˆì–´ì„œ ë¦¬ ë Œë”ê°€ ë°œìƒí•˜ê³  ìˆì—ˆë‹¤. ì•„ë˜ ì½”ë“œì™€ ê°™ì´ useCallbackì„ ì´ìš©í•´ì„œ í•¨ìˆ˜ë¼ ì¬ìƒì„±ë˜ëŠ” ë¶€ë¶„ì„ ë°©ì§€í•´ì£¼ì—ˆë‹¤.

```jsx
const handleMonthBtn = useCallback(() => {
  if (monthButton) {
    setClickButtonColor(monthButton);
    setCheckMonth(false);
    setGraphTitle(checkMonth ? "ì›”ê°„" : "ë…„ê°„");
  }
}, [graphTitle]);
const handlYearBtn = useCallback(() => {
  if (!yearButton) {
    setClickButtonColor(!monthButton);
    setCheckMonth(true);
    setGraphTitle(checkMonth ? "ì›”ê°„" : "ë…„ê°„");
  }
}, [graphTitle]);
```

- graphTitleê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì½œë°±ì„ ë°˜í™˜í•˜ë„ë¡ useCallbackë¥¼ ì‚¬ìš©í–ˆë‹¤.

![after](https://user-images.githubusercontent.com/81283255/153931885-546eb3ae-7528-436e-a9d7-f8cabd890e3b.gif)

## ğŸ“ Suspense

- [[React] ë¦¬ì•¡íŠ¸ React.lazyì™€ Suspenseë€?](https://lakelouise.tistory.com/327)

## ğŸ’¡ ì˜¤ëŠ˜ ê¹¨ë‹¬ì€ ê²ƒ

- ë¼ìš°í„°ê°€ ë°”ë€Œë©´ ëª¨ë“  ìš”ì†Œê°€ ë Œë”ë§ì´ ì¼ì–´ë‚œë‹¤.
  - [why my header render every time already use React.memo?](https://stackoverflow.com/questions/61377100/why-my-header-render-every-time-already-use-react-memo)
  - So in the case of your react-router, when you switch routes, every component will be re-rendered. The DOM may avoid unnecessary updates still, but your render functions will still get invoked.
- ì¬ ëœë”ê°€ ë°œìƒí•  ë•Œë§ˆë‹¤ ì½˜ì†”ì„ ì°ì–´ë³¸ë‹¤ -> ë‚´ê°€ ì˜ë„í•œ ê²ƒë³´ë‹¤ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œë˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤. -> ìµœì í™” ì‘ì—…
- suspenseë¥¼ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ì ê²½í—˜ì´ ë”ìš± í–¥ìƒë  ê±° ê°™ë‹¤!! ê·¸ë¦¬ê³  ê°œë°œìê³  í¸í•˜ê³ !
