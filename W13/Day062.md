# ğŸ“– ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš© - 2022.01.18

- json-server
- ë¦¬ì•¡íŠ¸, ë¦¬ë•ìŠ¤, ë¼ìš°í„°ë¥¼ ì‚¬ìš©í•œ í”„ë¡œì íŠ¸ ë³µìŠµ
- Development, Productionì˜ ì°¨ì´
- CI/CD

## ğŸ“ json-server

- ê°œë°œ ì´ˆê¸° apiê°€ ì•„ì§ ì•ˆ ë‚˜ì™”ì„ ë•Œ mockì„ ì‚¬ìš©í•´ì„œ ì‘ì—…í•  ìˆ˜ ìˆë‹¤.
- `db.json` íŒŒì¼ ë§Œë“¤ì–´ì£¼ê³  ì‚¬ìš©í•  ë°ì´í„°ë¥¼ ê°ì²´ë¡œ ë„£ì–´ì£¼ê¸°
- npx json-server --w db.json ì‹¤í–‰

```json
// db.json
{
  "topics": [
    {
      "title": "html5",
      "body": "html5 is ...",
      "id": 1
    },
    {
      "id": 2,
      "title": "css",
      "body": "css is..."
    },
    {
      "title": "js",
      "body": "js is ...",
      "id": 3
    }
  ]
}
```

```jsx
async function test() {
  let response = await fetch("http://localhost:3000/topics", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({ title: "js", body: "js is ..." }),
  });
  let result = await response.json();
}
test();
```

## ğŸ“ ë¦¬ì•¡íŠ¸, ë¦¬ë•ìŠ¤, ë¼ìš°í„°ë¥¼ ì‚¬ìš©í•œ í”„ë¡œì íŠ¸ ë³µìŠµ

### ğŸ“• ë¦¬ë•ìŠ¤, ë¦¬ì•¡íŠ¸-ë¦¬ë•ìŠ¤, ë¦¬ì•¡íŠ¸ ë¼ìš°í„° ì„¤ì¹˜

```bash
npm i redux react-redux react-router-dom
```

### ğŸ“• ë¦¬ë•ìŠ¤ ì„¸íŒ… ( ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ë¥¼ ë§Œë“ ë‹¤.)

```jsx
import { createStore } from "redux";

// ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ë¥¼ ë§Œë“ ë‹¤.
function reducer(state, action) {
  // state ë³€ê²½ ì½”ë“œ
  if (state === undefined) {
    return {
      topics: [],
    };
  }

  const newState = { ...state }; // ê°ì²´ëŠ” ë¶ˆë³€í•˜ê¸° ë•Œë¬¸ì— ë³µì œí•˜ì—¬ ì‚¬ìš©

  return newState; // ë³€ê²½ëœ stateê°€ ìƒˆë¡œìš´ stateê°€ ëœë‹¤.
}
const store = createStore(
  reducer,
  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()
);
```

### ğŸ“• react-reduxì ìš©

```jsx
import { Provider } from "react-redux";

ReactDOM.render(
  <React.StrictMode>
    <Provider store={store}>
      <App />
    </Provider>
  </React.StrictMode>,
  document.getElementById("root")
);
```

- Provider ì ìš©

### ğŸ“• í•„ìš”í•œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (useEffect ì‚¬ìš©)

```jsx
useEffect(() => {
  fetch("http://localhost:3333/topics")
    .then((type) => type.json())
    .then((result) => {
      // state.topics ì„ resultì˜ ê°’ìœ¼ë¡œ ë³€ê²½í•œë‹¤.
      console.log(result);
    });
}, []);
```

- ì•±ì´ ì‹¤í–‰ë  ë•Œ ë”± í•œ ë²ˆë§Œ ì‹¤í–‰ â‡’ useEffect ì‚¬ìš©
- ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì ì¸ ë³€í™”ë¥¼ ìœ„í•œ ì½”ë“œëŠ” `ë©”ì¸ ì´í™íŠ¸`
- ê·¸ ì™¸ë¥¼ ì‚¬ì´ë“œ ì´í™íŠ¸ë¼ê³  ë¶€ë¥¸ë‹¤. â‡’ useEffectì— ìœ„ì¹˜ì‹œì¼œì„œ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤.
  - ì˜ˆë¥¼ ë“¤ë©´ ì„œë²„ì™€ í†µì‹ í•´ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê¸°
- `npx json-server --port 3333 db.json`ìœ¼ë¡œ ì‹¤í–‰

### ğŸ“• fetchë¡œ ê°€ì ¸ì˜¨ topicsë¥¼ storeì— ì €ì¥ â‡’ ì‚¬ìš©

```jsx
// ìˆ˜ì •í•˜ê¸°
import { useDispatch } from "react-redux";

function App() {
  const dispatch = useDispatch();
  // topics ë°ì´í„°ë¥¼ 1íšŒ ê°€ì ¸ì˜¨ë‹¤.
  useEffect(() => {
    fetch("http://localhost:3333/topics")
      .then((type) => type.json())
      .then((result) => {
        // state.topics ì„ resultì˜ ê°’ìœ¼ë¡œ ë³€ê²½í•œë‹¤.
        console.log(result);
        dispatch({ type: "SET_TOPICS", topics: result });
      });
  }, []);
  return (
    <div>
      <Header></Header>
      <Nav></Nav>
      <Article></Article>
    </div>
  );
}
```

- useDispatch import í•´ì£¼ê³ , `const dispatch = useDispatch();` ì •ì˜
- `dispatch({ type: "SET_TOPICS", topics: result });` ì „ë‹¬

```jsx
// ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ë¥¼ ë§Œë“ ë‹¤.
function reducer(state, action) {
  // state ë³€ê²½ ì½”ë“œ
  if (state === undefined) {
    return {
      topics: [],
    };
  }
  const newState = { ...state };

  if (action.type === "SET_TOPICS") {
    newState.topics = action.topic;
  }

  return newState;
}
```

- reducerí•¨ìˆ˜ì—ì„œ `action.type === "SET_TOPICS"`ë¡œ storeì— ì €ì¥.

### ğŸ“• storeì— ì €ì¥í•œ ë°ì´í„°ë¥¼ ë³´ì—¬ì£¼ê¸° â‡’ useSelector

```jsx
import { useSelector } from "react-redux";

function Nav() {
  const topics = useSelector((state) => state.topics);
  return (
    <nav>
      <ul>
        <li>nav</li>
      </ul>
    </nav>
  );
}

export default Nav;
```

- useSelectorëŠ” stateë¥¼ ê°€ì ¸ì˜¨ë‹¤.
- `import { useSelector } from "react-redux";`
- `const topics = useSelector((state) => state.topics);`
- useSelectorëŠ” ì„ íƒí•œ ìƒíƒœë§Œ ë³€ê²½ì´ ë˜ì—ˆì„ ë•Œ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•´ì„œ ë¦¬ ë Œë”ë§ í•œë‹¤.

### ğŸ“• ë¦¬ì•¡íŠ¸ ë¼ìš°íŒ… ë” ì„¤ì •í•˜ê¸°

```jsx
ReactDOM.render(
  <React.StrictMode>
    <Provider store={store}>
      <BrowserRouter>
        <App />
      </BrowserRouter>
    </Provider>
  </React.StrictMode>,
  document.getElementById("root")
);
```

- import { BrowserRouter } from "react-router-dom";
- `<BrowserRouter>`ë¡œ ê°ì‹¸ì£¼ê¸°

### ğŸ“• aíƒœê·¸ëŠ” `<Link to="">`ë¡œ ë°”ê¿”ì£¼ê¸°

```jsx
import { useSelector } from "react-redux";
import { Link } from "react-router-dom";

function Nav() {
  const topics = useSelector((state) => state.topics);
  let lis = [];
  for (let i = 0; i < topics.length; i++) {
    lis.push(
      <li key={topics[i].id}>
        <Link to={"/read/" + topics[i].id}>{topics[i].title}</Link>
      </li>
    );
  }
  return (
    <nav>
      <ul>{lis}</ul>
    </nav>
  );
}
export default Nav;
```

### ğŸ“• Route, Routes ì„¤ì •í•´ì£¼ê¸°

```jsx
import { Route, Routes } from "react-router-dom";

return (
  <div>
    <Header></Header>
    <Nav></Nav>
    <Article></Article>
    <Routes>
      <Route
        path="/"
        element={
          <article>
            <h1>Welcome</h1>Hello, WEB
          </article>
        }
      ></Route>
      <Route
        path="/read/:id"
        element={
          <article>
            <h1>Read</h1>
          </article>
        }
      ></Route>
    </Routes>
  </div>
);
```

- `<Routes><Route path="/" element={<App />}></Route></Routes>`
- ì´ë ‡ê²Œ ì„¤ì •í•´ì£¼ë©´ ëœë‹¤.
- pathëŠ” ê²½ë¡œë¥¼ ì ì–´ì£¼ê³  elementë¡œ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ë¥¼ ë„˜ê²¨ì¤€ë‹¤.

### ğŸ“• idê°’ ê°€ì ¸ì˜¤ê¸° (useParams)

```jsx
import { useEffect, useState } from "react";
import { useParams } from "react-router-dom";

export function Read() {
  // const params = useParams();
  // cosnt id = params.id
  const { id } = useParams();
  const [topic, setTopic] = useState();

  // idì˜ ê°’ì´ ë°”ë€” ë•Œ ë§ˆë‹¤ useEffectê°€ ì‹¤í–‰.
  useEffect(() => {
    // topics/id ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    fetch("http://localhost:3333/topics/" + id)
      .then((type) => type.json())
      .then((result) => {
        setTopic(result);
      });
  }, [id]);
  if (topic === undefined) {
    return <>Loading...</>;
  }
  return (
    <article>
      <h1>Read</h1>
    </article>
  );
}
```

- `import { Route, Routes, useParams } from "react-router-dom";`
- `const { id } = useParams();`

### ğŸ“• í˜ì´ì§€ ì´ë™ ì„¤ì • (useNavigate)

```jsx
const go = useNavigate();

...
<form
    onSubmit={async (e) => {
    e.preventDefault();
    const newTopic = await postTopic(e);
    go("/read/" + newTopic.id);

    const response = await fetch("http://localhost:3333/topics");
    const topics = await response.json();
    dispatch({ type: "SET_TOPICS", topics: topics });
    }}
>
...
```

## ğŸ“ ë¦¬ì•¡íŠ¸ í”„ë¡œì íŠ¸ Productionìœ¼ë¡œ ë°”ê¾¸ê¸°

```bash
npm run build

// ì„¤ì¹˜
npm install -g serve

// ì‹¤í–‰
serve -s build
```

### ğŸ“• Production levelì¸ ê²½ìš°ì—ë§Œ ì–´ë–¤ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ê³  ì‹¶ë‹¤ë©´

```javascript
// index.js
if (process.env.NODE_ENV !== "production") {
  console.log("í˜„ì¬ Production ë¹Œë“œë¡œ ëŒì•„ê°€ê³  ìˆì–´ìš”!");
}
```

- ì´ê±¸ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ëŠ” ë§ì§€ ì•Šì§€ë§Œ ì´ë ‡ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

## ğŸ’¡ ì˜¤ëŠ˜ ê¹¨ë‹¬ì€ ê²ƒ

- ì˜¤ëŠ˜ ì „ì²´ì ì¸ ë³µìŠµì„ í•˜ë‹ˆê¹Œ ë¦¬ì•¡íŠ¸ì˜ ì „ì²´ì ì¸ íë¦„ì— ëŒ€í•´ì„œ ê°ì„ ì¡ê¸° ì‹œì‘í–ˆë‹¤!! ì—­ì‹œ ë°˜ë³µì´ ë‹µì´ë‹¤!!
- ë§Œì•½ ì¬ì‚¬ìš©ì„±ì„ ê³ ë ¤í•œë‹¤ë©´ storeë¡œ ë°›ê¸°ë³´ë‹¤ëŠ” propsë¡œ ë°›ëŠ” ê²ƒì´ ë” ë‚˜ì„ ìˆ˜ë„ ìˆë‹¤.
- Developmentê³¼ Productionì˜ ì°¨ì´ì ì€ ë””ë²„ê¹… ê¸°ëŠ¥ì˜ ìœ ë¬´ì´ë‹¤. ê·¸ë˜ì„œ Developmentê°€ ëŠë¦¬ë‹¤.
- í¬íŠ¸ëŠ” í•œì •ì ì¸ë° ì—¬ëŸ¬ ê°œë¥¼ ëŒë¦¬ê³  ì‹¶ë‹¤ë©´? => Proxy Server ì‚¬ìš©!!
  - í¬íŠ¸ê°€ ë§‰í˜€ìˆëŠ”ë° ë” í•„ìš”í•˜ë‹¤ë©´ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¥¼ ì´ìš©í•´ì„œ í¬íŠ¸ë¥¼ ë‹¤ ëš«ì–´ ë†“ì„ ìˆ˜ ìˆë‹¤.
- git ë¬¸ì œ ìƒí™© ì‹œë‚˜ë¦¬ì˜¤ ì—°ìŠµ : [Git Exercises](https://gitexercises.fracz.com/)
