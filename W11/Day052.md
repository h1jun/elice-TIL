# ğŸ“– ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš© - 2022.01.04

- dangerouslySetInnerHTML
- ì¹´ì¹´ì˜¤ api ì‚¬ìš©

## ğŸ“ ì´ë¡  ì‹œê°„ ì½”ë“œ

```jsx
import "./App.css";
import { useState } from "react";

function Header(props) {
  console.log("Header");
  function onClickHandler(evt) {
    evt.preventDefault();
    props.onChangeMode("WELCOME");
  }
  return (
    <header>
      <h1>
        <a href="index.html" onClick={onClickHandler}>
          {props.title}
        </a>
      </h1>
    </header>
  );
}

function Nav(props) {
  let lis = [];
  function clickHandler(evt) {
    evt.preventDefault();
    props.onChangeMode("READ", Number(evt.target.dataset.id));
  }
  for (let i = 0; i < props.data.length; i++) {
    let d = props.data[i];
    lis.push(
      <li key={d.id}>
        <a href={"/read/" + d.id} data-id={d.id} onClick={clickHandler}>
          {d.title}
        </a>
      </li>
    );
  }
  return (
    <nav>
      <ol>{lis}</ol>
    </nav>
  );
}

function Article({ title, body }) {
  console.log("Article");
  return (
    <article>
      <h2>{title}</h2>
      {body}
    </article>
  );
}

function Create(props) {
  function submitHandler(evt) {
    evt.preventDefault();
    let title = evt.target.title.value;
    let body = evt.target.body.value;
    props.onSubmit(title, body);
    console.log(title);
  }
  return (
    <article>
      <h2>Create</h2>
      <form onSubmit={submitHandler}>
        <p>
          <input type="text" name="title" placeholder="title" />
        </p>
        <p>
          <textarea name="body" placeholder="body"></textarea>
        </p>
        <p>
          <input type="submit" value="create" />
        </p>
      </form>
    </article>
  );
}

function Update(props) {
  const [title, setTitle] = useState(props.title);
  const [body, setBody] = useState(props.body);

  function submitHandler(evt) {
    evt.preventDefault();
    let title = evt.target.title.value;
    let body = evt.target.body.value;
    props.onSubmit(title, body);
    console.log(title);
  }
  return (
    <article>
      <h2>Update</h2>
      <form onSubmit={submitHandler}>
        <p>
          <input
            type="text"
            name="title"
            placeholder="title"
            value={title}
            onChange={(evt) => setTitle(evt.target.value)}
          />
        </p>
        <p>
          <textarea
            name="body"
            placeholder="body"
            value={body}
            onChange={(evt) => setBody(evt.target.value)}
          ></textarea>
        </p>
        <p>
          <input type="submit" value="update" />
        </p>
      </form>
    </article>
  );
}

function App() {
  const [mode, setMode] = useState("WELCOME");
  const [id, setId] = useState(null);
  const [nextId, setNextId] = useState(4);
  const [topics, setTopics] = useState([
    { id: 1, title: "html", body: "html is ..." },
    { id: 2, title: "css", body: "css is ..." },
    { id: 3, title: "js", body: "js is ..." },
  ]);

  function changeModeHandler(_mode, _id) {
    if (_mode === "DELETE") {
      let newTopics = [];
      for (let i = 0; i < topics.length; i++) {
        if (topics[i].id !== id) {
          newTopics.push(topics[i]);
        }
      }
      setTopics(newTopics);
      setMode("WELCOME");
      return;
    }
    setMode(_mode);
    setId(_id);
  }

  let articleTag;
  if (mode === "WELCOME") {
    articleTag = <Article title="Welcome" body="Hello, React!" />;
  } else if (mode === "READ") {
    let title = null;
    let body = null;
    for (let i = 0; i < topics.length; i++) {
      if (topics[i].id === id) {
        title = topics[i].title;
        body = topics[i].body;
      }
    }
    articleTag = <Article title={title} body={body} />;
  } else if (mode === "CREATE") {
    articleTag = (
      <Create
        onSubmit={(_title, _body) => {
          let newTopic = { id: nextId, title: _title, body: _body };
          let newTopics = [...topics];
          newTopics.push(newTopic);
          setTopics(newTopics);
          setMode("READ");
          setId(nextId);
          setNextId(nextId + 1);
        }}
      ></Create>
    );
  } else if (mode === "UPDATE") {
    let title = null;
    let body = null;
    for (let i = 0; i < topics.length; i++) {
      console.log(topics[i].id, id);
      if (topics[i].id === id) {
        title = topics[i].title;
        body = topics[i].body;
      }
    }

    articleTag = (
      <Update
        title={title}
        body={body}
        onSubmit={(title, body) => {
          let newTopics = [...topics];
          for (let i = 0; i < newTopics.length; i++) {
            if (newTopics[i].id === id) {
              newTopics[i].title = title;
              newTopics[i].body = body;
            }
          }
          setTopics(newTopics);
          setMode("READ");
        }}
      ></Update>
    );
  }

  return (
    <>
      <Header title="WEB" onChangeMode={changeModeHandler} />
      <Nav data={topics} onChangeMode={changeModeHandler} />
      {articleTag}
      <Control onChangeMode={changeModeHandler} selectedId={id} />
    </>
  );
}

function Control(props) {
  function ClickHandler(evt) {
    evt.preventDefault();
    props.onChangeMode("CREATE");
  }
  function ClickUpdateHandler(evt) {
    evt.preventDefault();
    props.onChangeMode("UPDATE", props.selectedId);
  }
  let contextUI = null;
  if (props.selectedId > 0) {
    contextUI = (
      <>
        <li>
          <a href={"/update/" + props.selectedId} onClick={ClickUpdateHandler}>
            update
          </a>
        </li>
        <li>
          <form
            onSubmit={(evt) => {
              evt.preventDefault();
              props.onChangeMode("DELETE");
            }}
          >
            <input type="submit" value="delete" />
          </form>
        </li>
      </>
    );
  }
  return (
    <ul>
      <li>
        <a href="/create" onClick={ClickHandler}>
          create
        </a>
      </li>
      {contextUI}
    </ul>
  );
}
export default App;
```

- ì‚­ì œëŠ” linkë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  formì„ ì‚¬ìš©í•œë‹¤.

## ğŸ“ Stateì˜ ìœ„ì¹˜ ì°¾ê¸°

- ReactëŠ” í•­ìƒ ì»´í¬ë„ŒíŠ¸ ê³„ì¸µ êµ¬ì¡°ë¥¼ ë”°ë¼ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ëŠ” ë‹¨ë°©í–¥ ë°ì´í„° íë¦„ì„ ë”°ë¥¸ë‹¤.
- stateë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë Œë”ë§ í•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë¥¼ ì°¾ëŠ”ë‹¤.
- ê³µí†µëœ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ë¥¼ ì°¾ëŠ”ë‹¤.
- ê³µí†µëœ ë¶€ëª¨ í˜¹ì€ ë” ìƒìœ„ì— ìˆëŠ” ì»´í¬ë„ŒíŠ¸ê°€ stateë¥¼ ê°€ì ¸ì•¼ í•œë‹¤.
- stateë¥¼ ì†Œìœ í•  ì ì ˆí•  ì»´í¬ë„ŒíŠ¸ë¥¼ ì°¾ì§€ ëª»í–ˆë‹¤ë©´, ë‹¨ìˆœ stateë¥¼ ì†Œìœ í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒì„±í•˜ì—¬ ê³µí†µëœ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì˜ ìƒìœ„ ê³„ì¸µì— ì¶”ê°€í•œë‹¤.

## ğŸ“ ì—­ë°©í–¥ìœ¼ë¡œ ë°ì´í„° íë¦„ ì¶”ê°€í•˜ê¸°

```jsx
import React, { useState } from "react";
import ReactDOM from "react-dom";
import "./index.css";
import App from "./App";
import * as serviceWorker from "./serviceWorker";

function ProductCategoryRow(props) {
  return (
    <tr>
      <th colSpan="2">{props.category}</th>
    </tr>
  );
}

function ProductRow(props) {
  let name;
  if (props.product.stocked) {
    name = props.product.name;
  } else {
    name = <span style={{ color: "red" }}>{props.product.name}</span>;
  }

  return (
    <tr>
      <td>{name}</td>
      <td>{props.product.price}</td>
    </tr>
  );
}

// ì´ì œ ì¶”ê°€ì ì¸ ë°ì´í„°ë¥¼ ë” ë°›ìœ¼ë‹ˆ, ì´ë¦„ì´ ë­”ì§€ í™•ì¸í•  í•„ìš”ê°€ ìˆìŒ.
// forEach ë¶€ë¶„ì—ì„œ, ëª¨ë“  ë°ì´í„°ë¥¼ ë‹¤ ë°›ì§€ ì•ŠìŒ.
// ì´ ê²½ìš°, ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ê²Œ ì¢‹ì„ê¹Œ?

function ProductTable(props) {
  const rows = [];
  let lastCategory = null;

  props.products.forEach((product) => {
    // filterTextê°€ ë¬¼ê±´ ì´ë¦„ì— í¬í•¨ì´ ë˜ì–´ ìˆë‚˜??
    // ë§Œì•½ì— ì²´í¬ê°€ ë˜ì–´ ìˆë‹¤ë©´, ì´ ìƒí’ˆì˜ stocked ìƒíƒœë„ ë´ì•¼ í•˜ì§€ ì•Šì„ê¹Œ?

    // "sa", "sandbox" "asa"
    // 1. if (!product.name.includes(props.filterText)) return;
    // 2. product.name.indexOf(props.filterText) === -1 return;
    if (!product.name.includes(props.filterText)) return;
    if (props.inStockOnly && !product.stocked) return;

    if (product.category !== lastCategory) {
      rows.push(
        <ProductCategoryRow
          category={product.category}
          key={product.category}
        />
      );
    }
    rows.push(<ProductRow product={product} key={product.name} />);
    lastCategory = product.category;
  });

  return (
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Price</th>
        </tr>
      </thead>
      <tbody>{rows}</tbody>
    </table>
  );
}

// ì´ë²¤íŠ¸ë§Œ ì¶”ê°€í•˜ë©´ ë¨...

function SearchBar(props) {
  return (
    <form>
      <input
        type="text"
        placeholder="Search..."
        value={props.filterText}
        onChange={(e) => {
          props.onFilterTextChange(e.target.value);
        }}
      />
      <p>
        <input
          type="checkbox"
          checked={props.inStockOnly}
          onChange={(e) => {
            props.onInStockChange(e.target.checked);
          }}
        />
        Only show products in stock
      </p>
    </form>
  );
}

// í•„í„° ì •ë³´ëŠ” ProductTableë„ ì•Œì•„ì•¼ í•˜ê³ , SearchBarë„ ì•Œì•„ì•¼ í•¨.
// ì´ ë°”ë€ŒëŠ” ì •ë³´ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ìˆì„ê¹Œ?
// Hint : SearchBarê°€ ê¸°ë¡ì„ ë°”ê¾¸ë‹ˆ, ì—¬ê¸°ì—ë‹¤ ì¶”ê°€ì ìœ¼ë¡œ ë­”ê°€ë¥¼ ë” ì „ë‹¬í•˜ì.

function FilterableProductTable(props) {
  const [filterText, filterTextChange] = useState("");
  const [inStockOnly, inStockOnlyChange] = useState(false);

  return (
    <div>
      <SearchBar
        filterText={filterText}
        inStockOnly={inStockOnly}
        onFilterTextChange={filterTextChange}
        onInStockChange={inStockOnlyChange}
      />
      <ProductTable
        products={props.products}
        filterText={filterText}
        inStockOnly={inStockOnly}
      />
    </div>
  );
}

const PRODUCTS = [
  {
    category: "Sporting Goods",
    price: "$49.99",
    stocked: true,
    name: "Football",
  },
  {
    category: "Sporting Goods",
    price: "$9.99",
    stocked: true,
    name: "Baseball",
  },
  {
    category: "Sporting Goods",
    price: "$29.99",
    stocked: false,
    name: "Basketball",
  },
  {
    category: "Electronics",
    price: "$99.99",
    stocked: true,
    name: "iPod Touch",
  },
  {
    category: "Electronics",
    price: "$399.99",
    stocked: false,
    name: "iPhone 5",
  },
  { category: "Electronics", price: "$199.99", stocked: true, name: "Nexus 7" },
];

ReactDOM.render(
  <FilterableProductTable products={PRODUCTS} />,
  document.getElementById("container")
);

serviceWorker.unregister();
```

- propsë¥¼ ë¶€ëª¨ì—ê²Œ ì „ë‹¬í•  ìˆ˜ ì—†ìœ¼ë‹ˆê¹Œ ë¶€ëª¨ì—ì„œ setChange í•¨ìˆ˜ë¥¼ propsë¡œ ë„˜ê²¨ì£¼ê³  ìì‹ì—ì„œ ê·¸ í•¨ìˆ˜ë¥¼ ì‹¤í–‰.
- ê·¸ë¦¬ê³  ë¶€ëª¨ëŠ” ë³´ì—¬ì£¼ëŠ” ê³³ì— propsë¡œ ì „ë‹¬í•´ì£¼ë©´ ëœë‹¤.

## ğŸ’¡ ì˜¤ëŠ˜ ê¹¨ë‹¬ì€ ê²ƒ

- `dangerouslySetInnerHTML`ì€ ë¸Œë¼ìš°ì € DOMì—ì„œ `innerHTML`ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ Reactì˜ ëŒ€ì²´ ë°©ë²•ì´ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì½”ë“œì—ì„œ HTMLì„ ì„¤ì •í•˜ëŠ” ê²ƒì€ ì‚¬ì´íŠ¸ ê°„ ìŠ¤í¬ë¦½íŒ… ê³µê²©ì— ì‰½ê²Œ ë…¸ì¶œë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ìœ„í—˜í•˜ë‹¤.

```jsx
function createMarkup() {
  return { __html: "First &middot; Second" };
}

function MyComponent() {
  return <div dangerouslySetInnerHTML={createMarkup()} />;
}
```

## ğŸ“Œ ì°¸ê³ 

- [DOM ì—˜ë¦¬ë¨¼íŠ¸ - React](https://ko.reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml)
