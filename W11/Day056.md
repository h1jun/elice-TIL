# ğŸ“– ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš© - 2022.01.08

- ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¹„ë™ê¸°
- Promise
- CORS(Cross-Origin Resource Sharing)

## ğŸ“ ë™ê¸° vs ë¹„ë™ê¸°

### ğŸ“• ë™ê¸°(synchronous)

```jsx
console.log("This is synchronous...");

for (let i = 0; i < 1000000000; ++i) {
  console.log("I am blocking the main thread...");
}

console.log("This is synchronous...DONE!");
```

- **ë™ê¸°(synchronous) ì½”ë“œ**ëŠ”, í•´ë‹¹ ì½”ë“œ ë¸”ë¡ì„ ì‹¤í–‰í•  ë•Œ threadì˜ ì œì–´ê¶Œì„ ë„˜ê¸°ì§€ ì•Šê³  ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
- ë™ê¸° ì½”ë“œëŠ” ë°”ë¡œ call stackì— ë„£ì–´ì§„ë‹¤.
- ë™ê¸° ì½”ë“œëŠ” main threadì— ì˜í•´ ì‹¤í–‰ë˜ë¯€ë¡œ, ë¬´í•œë£¨í”„ ë“±ì— ì˜í•´ main threadë¥¼ ë¸”ë¡ í•  ìˆ˜ ìˆë‹¤.

### ğŸ“• ë¹„ë™ê¸°(asynchronous)

```jsx
setTimeout(() => console.log("This is asynchronous..."), 5000);

console.log("This is synchronous...");

for (let i = 0; i < 1000000000; ++i) {
  console.log("I am blocking the main thread...");
}

/* result
This is synchronous...
I am blocking the main thread...
...
I am blocking the main thread...
This is asynchronous...
*/
request("user-data", (userData) => {
  console.log("userData ë¡œë“œ");
  saveUsers(userData);
});

console.log("DOM ë³€ê²½");
console.log("ìœ ì € ì…ë ¥");
```

- **ë¹„ë™ê¸°(asynchronous) ì½”ë“œ**ëŠ”, ì½”ë“œì˜ ìˆœì„œì™€ ë‹¤ë¥´ê²Œ ì‹¤í–‰ëœë‹¤.
- ë¹„ë™ê¸° ì²˜ë¦¬ ì½”ë“œë¥¼ ê°ì‹¼ ë¸”ë¡ì€ task queueì— ë„£ì–´ì§„ë‹¤.
- main threadê°€ ë™ê¸° ì½”ë“œë¥¼ ì‹¤í–‰í•œ í›„ì— ì œì–´ê¶Œì´ ëŒì•„ì™”ì„ ë•Œ event loopê°€ task queueì— ë„£ì–´ì§„ ë¹„ë™ê¸° ì½”ë“œë¥¼ ì‹¤í–‰í•œë‹¤.

## ğŸ“ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ ë‚´ë¶€ êµ¬ì¡°

- ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ë˜ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œëŠ” event driven ì‹œìŠ¤í…œìœ¼ë¡œ ì‘ë™í•œë‹¤.
  - ìš”ì•½í•˜ìë©´ ì „ì²´ ì‹œìŠ¤í…œì´ ì´ë²¤íŠ¸ê°€ ë“¤ì–´ì˜¤ê³  ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ë™í•œë‹¤.
- ì›¹ì•±ì„ ë¡œë“œí•˜ë©´ ë¸Œë¼ìš°ì €ëŠ” HTML documentë¥¼ ì½ì–´ ë¬¸ì„œì— ìˆëŠ” CSS code, JS codeë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤.
- ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì€ ì½”ë“œë¥¼ ì½ì–´ ì‹¤í–‰í•œë‹¤.
- ë¸Œë¼ìš°ì €ì˜ main threadëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œì—ì„œ ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ì•¼ í•  ì½”ë“œ ì‹¤í–‰ ì™¸ì—ë„, ì›¹ í˜ì´ì§€ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë Œë”ë§ í•˜ê³ , ìœ ì €ì˜ ì…ë ¥ì„ ê°ì§€í•˜ê³ , ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ ì²˜ë¦¬í•˜ëŠ” ë“± ìˆ˜ë§ì€ ì¼ì„ ì²˜ë¦¬í•œë‹¤.
- ë¹„ë™ê¸° ì‘ì—…ì„ í• ë‹¹í•˜ë©´, ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ëë‚˜ê³  ë¸Œë¼ìš°ì €ëŠ” task queueì— ì‹¤í–‰ì½”ë“œë¥¼ ë„£ëŠ”ë‹¤
- main threadëŠ” event loopë¥¼ ëŒë ¤, task queueì— ì‘ì—…ì´ ìˆëŠ”ì§€ ì²´í¬í•œë‹¤.
- ì‘ì—…ì´ ìˆìœ¼ë©´ taskë¥¼ ì‹¤í–‰í•œë‹¤.

```jsx
request("user-data", (userData) => {
  console.log("userData ë¡œë“œ");
  saveUsers(userData);
});

console.log("DOM ë³€ê²½");
console.log("ìœ ì € ì…ë ¥");
```

## ğŸ“ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ ë‚´ë¶€ êµ¬ì¡° - ë‹¤ì´ì–´ê·¸ë¨

- task queueì´ë€?
  - ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ë°œìƒí–ˆì„ ë•Œ ì¼ë“¤ì´ ë“¤ì–´ì˜¤ëŠ” queue
  - ì¦‰ ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ë°œìƒí•˜ë©´ task queueë¡œ ë“¤ì–´ì˜¨ë‹¤.
- Event Loopë€?
  - main threadì— ì—¬ìœ ê°€ ìƒê²¼ì„ ë•Œ task queueì—ì„œ êº¼ë‚´ì™€ì„œ call stackì—ì„œ ë„£ëŠ” ì—­í• ì„ í•˜ëŠ” ëª¨ë“ˆì´ë‹¤.
- call stackì´ë€?
  - í•¨ìˆ˜ë¥¼ í˜¸ì¶œí–ˆì„ ë•Œ ê·¸ í•¨ìˆ˜ê°€ ë‚´ë¶€ì ìœ¼ë¡œ ë˜ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ì½œìŠ¤íƒì— ê·¸ í•¨ìˆ˜ì˜ ì‹œì‘ ì£¼ì†Œê°€ ê³„ì† ìŒ“ì¸ë‹¤.

## ğŸ“ Promise

- Promise ê°ì²´ëŠ”, ê°ì²´ê°€ ìƒì„± ë‹¹ì‹œì—ëŠ” ì•Œë ¤ì§€ì§€ ì•Šì€ ë°ì´í„°ì— ëŒ€í•œ Proxyë‹¤.
- ë¹„ë™ê¸° ì‹¤í–‰ì´ ì™„ë£Œëœ í›„ì—, `.then`, `.catch`, `.finally` ë“±ì˜ í•¸ë“¤ëŸ¬ë¥¼ ë¶™ì—¬ ê°ê° ë°ì´í„° ì²˜ë¦¬ ë¡œì§, ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§, í´ë¦°ì—… ë¡œì§ì„ ì‹¤í–‰í•œë‹¤.
- then ì²´ì¸ì„ ë¶™ì—¬, ë¹„ë™ê¸° ì‹¤í–‰ì„ ë§ˆì¹˜ ë™ê¸° ì‹¤í–‰ì²˜ëŸ¼ ë™ì‘í•˜ë„ë¡ í•´ì¤€ë‹¤.

```jsx
function returnPromise() {
  // promise ê°ì²´ë¥¼ return í•œë‹¤.
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      const randomNumber = generateRandomNumber(100);
      if (randomNumber < 50) resolve(randomNumber);
      else reject(new Error("Random number is too small."));
    }, 1000);
  });
}
returnPromise()
  .then((num) => {
    console.log("First random number : ", num);
  })
  .catch((error) => {
    console.error("Error occured : ", error);
  })
  .finally(() => {
    console.log("Promise returned.");
  });
```

- Promise ê°ì²´ëŠ” pending, fulfilled, rejected 3ê°œì˜ ìƒíƒœë¥¼ ê°€ì§„ë‹¤.
- `fulfilled`, `rejected` ë‘ ìƒíƒœë¥¼ settledë¼ê³  ì§€ì¹­í•œë‹¤.
- `pending` : ë¹„ë™ê¸° ì‹¤í–‰ì´ ëë‚˜ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ìƒíƒœ
- `fulfilled` : ë¹„ë™ê¸° ì‹¤í–‰ì´ ì„±ê³µí•œ ìƒíƒœ
- `rejected` : ë¹„ë™ê¸° ì‹¤í–‰ì´ ì‹¤íŒ¨í•œ ìƒíƒœ
- then, catchëŠ” ë¹„ë™ê¸°(Promise), ë™ê¸° ì‹¤í–‰ ì¤‘ ì–´ë–¤ ê²ƒì´ë¼ë„ ë¦¬í„´í•  ìˆ˜ ìˆë‹¤.

## ğŸ“ Multiple Promise handling(Promise.all, Promise.allSettled, Promise.race, Promise.any)

- `Promise.all()`ì€ ëª¨ë“  í”„ë¡œë¯¸ìŠ¤ê°€ fulfilled ë˜ê¸¸ ê¸°ë‹¤ë¦°ë‹¤. í•˜ë‚˜ë¼ë„ ì—ëŸ¬ ë°œìƒ ì‹œ, ëª¨ë“  í”„ë¡œë¯¸ìŠ¤ ìš”ì²­ì´ ì¤‘ë‹¨ëœë‹¤.
- `Promise.allSettled()` : ëª¨ë“  í”„ë¡œë¯¸ìŠ¤ê°€ settled ë˜ê¸¸ ê¸°ë‹¤ë¦°ë‹¤.
- `Promise.race()` : ë„˜ê²¨ì§„ í”„ë¡œë¯¸ìŠ¤ë“¤ ì¤‘ í•˜ë‚˜ë¼ë„ settled ë˜ê¸¸ ê¸°ë‹¤ë¦°ë‹¤.
- `Promise.any()` : ë„˜ê²¨ì§„ í”„ë¡œë¯¸ìŠ¤ ì¤‘ í•˜ë‚˜ë¼ë„ fulfilled ë˜ê¸¸ ê¸°ë‹¤ë¦°ë‹¤.

### ğŸ“• Promise.all

```jsx
Promise.all(
	users.map(user => request('/users/detail', user.name))
	// [Promise, Promise, ... ,Promise ]
)
	.then(console.log) // [UserNameData, UserNameData, ..., UserNameData]
	.catch(e => console.error("í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")
```

### ğŸ“• Promise.allSettled

```jsx
function saveLogRetry(logs, retryNum) {
  if (retryNum >= 3) return; // no more try.

  Promise.allSettled(logs.map(saveLog)) // saveLog("log a"), saveLog("log b") ì´ë ‡ê²Œ í˜¸ì¶œ
    .then((results) => {
      return results.filter((result) => result.status === "rejected");
    })
    .then((failedPromises) => {
      // ìœ„ì—ì„œ returnëœ ê²ƒì„ ì—¬ê¸°ì„œ ë°›ëŠ”ë‹¤.
      saveLogRetry(
        // ì¬ê·€
        failedPromises.map((promise) => promise.reason.failedLog),
        retryNum + 1
      );
    });
}
```

### ğŸ“• Promise.race

```jsx
function requestWithTimeout(request, timeout = 1000) {
  return Promise.race([request, wait(timeout)]).then((data) => {
    console.log("ìš”ì²­ ì„±ê³µ.");
    return data;
  });
}

requestWithTimeout(req)
  .then((data) => console.log("data : ", data))
  .catch(() => console.log("íƒ€ì„ì•„ì›ƒ ì—ëŸ¬!"));
```

### ğŸ“• Promise.any

```jsx
function getAnyData(dataList) {
  Promise.any(dataList.map((data) => request(data.url)))
    .then((data) => {
      console.log("ê°€ì¥ ì²« ë²ˆì§¸ë¡œ ê°€ì ¸ì˜¨ ë°ì´í„° : ", data);
    })
    .catch((e) => {
      console.log("ì•„ë¬´ê²ƒë„ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
    });
}
```

## ğŸ“ async/await

- Promise ì²´ì¸ì„ êµ¬ì¶•í•˜ì§€ ì•Šê³ ë„, Promiseë¥¼ ì§ê´€ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¬¸ë²•ì´ë‹¤.
- ë§ì€ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì— ìˆëŠ” try... catch ë¬¸ìœ¼ë¡œ ì—ëŸ¬ë¥¼ ì§ê´€ì ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤.
- async functionì„ ë§Œë“¤ê³ , Promiseë¥¼ ê¸°ë‹¤ë ¤ì•¼ í•˜ëŠ” í‘œí˜„ ì•ì— awaitì„ ë¶™ì¸ë‹¤.

### ğŸ“• async/await - ì—¬ëŸ¬ ê°œì˜ await

- ì—¬ëŸ¬ ê°œì˜ awaitì„ ìˆœì„œëŒ€ë¡œ ë‚˜ì—´í•˜ì—¬, then chainì„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
- try... catch ë¬¸ì„ ììœ ë¡­ê²Œ í™œìš©í•˜ì—¬ ì—ëŸ¬ ì²˜ë¦¬ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤.

```jsx
async function fetchUserWithAddress(id) {
  try {
    const user = await request(`/user/${id}`);
    const address = await request(`/user/${user.id}/address`);
    return { ...user, address };
  } catch (e) {
    console.log("error : ", e);
  }
}
```

### ğŸ“• try... catchë¥¼ ì—¬ëŸ¬ê°œ ì‚¬ìš©í•˜ì—¬ ì—ëŸ¬ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•

```jsx
async function fetchUserWithAddress(id) {
  let user = null;

  try {
    user = await request(`/user/${user.id}`);
  } catch (e) {
    console.log("User fetch error: ", e);
    return;
  }

  try {
    const address = await request(`/user/${user.id}/address`);
    return { ...user, address };
  } catch (e) {
    console.log("Address fetch error: ", e);
  }
}
```

### ğŸ“• throw new Errorë¥¼ í†µí•´ ì¤‘ê°„ì—ì„œ ì—ëŸ¬ì²˜ë¦¬

```jsx
async function fetchUserWithAddress(id) {
  try {
    const user = await request(`/user/${user.id}`);
    if (!user) throw new Error("No user found.");

    const address = await request(`/user/${user.id}/address`);
    if (!address.userId !== user.id)
      throw new Error("No address match with user.");

    return { ...user, address };
  } catch (e) {
    console.log("User fetch error: ", e);
  }
}
```

### ğŸ“• nested try-catch

```jsx
async function fetchUserWithAddress(id) {
  try {
    const user = await request(`/user/${id}`);
    const address = await request(`/user/${user.id}/address`);
    return { ...user, address };
  } catch (e) {
    try {
      await sendErrorLog(e);
    } catch (e) {
      console.error("ì—ëŸ¬ë¥¼ ë¡œê¹…í•˜ëŠ”ë° ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.");
    }
  }
}
```

## ğŸ“ async/await - Promise ì™€ì˜ ì¡°í•©

- Promise.allì€ íŠ¹ì • ë¹„ë™ê¸° ì‘ì—…ì´ ìƒëŒ€ì ìœ¼ë¡œ ë¹ ë¥´ê²Œ ëë‚˜ë„ ëŠë¦° ì²˜ë¦¬ë¥¼ ëê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ë§Œ í•œë‹¤.
- ì´ì™€ ë‹¬ë¦¬, async/awaitì„ í™œìš©í•  ê²½ìš° parallelismì„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
- ì¦‰, ëë‚œ ëŒ€ë¡œ ë¨¼ì € ì²˜ë¦¬ë  ìˆ˜ ìˆë‹¤.

```jsx
async function fetchUserWithAddress(id) {
  return await Promise.all([
    (async () => await request(`/users/${id}`))(),
    (async () => await request(`/users/${id}/address`))(),
  ]);
}

fetchUserWithAddress("1234")
  .then(([user, address]) => ({ ...user, address }))
  .catch((e) => console.log("Error : ", e));
```

## ğŸ“ POSTMAN

- POSTMANì€ APIë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ ê°œë°œ ë„êµ¬ë‹¤.
- Auth, header, payload, query ë“± API ìš”ì²­ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ì‰½ê²Œ ì„¸íŒ…í•  ìˆ˜ ìˆë‹¤.
- ë‹¤ë¥¸ ê°œë°œìê°€ ì‰½ê²Œ ì…‹ì—…í•´ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë„ë¡ API ì •ë³´ë¥¼ ê³µìœ í•  ìˆ˜ ìˆë‹¤.
- Requestë¥¼ ëª¨ì•„ Collectionìœ¼ë¡œ ë§Œë“¤ì–´, APIë¥¼ ì¢…ë¥˜ë³„ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.
- í™˜ê²½ ë³€ìˆ˜ë¥¼ ì •ì˜í•˜ì—¬, í™˜ê²½ë³„ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•˜ë‹¤.
- https://www.postman.com/

## ğŸ“ Open API

- RESTful APIë¥¼ í•˜ë‚˜ì˜ ë¬¸ì„œë¡œ ì •ì˜í•˜ê¸° ìœ„í•œ ë¬¸ì„œ í‘œì¤€ì´ë‹¤.
- OpenAPI Specification(OAS)ìœ¼ë¡œ ì •ì˜ëœë‹¤.
- Swagger ë“±ì˜ íˆ´ë¡œ, Open APIë¡œ ì‘ì„±ëœ ë¬¸ì„œë¥¼ íŒŒì‹± í•´ í…ŒìŠ¤íŒ… ë„êµ¬ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
- í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì, ë°±ì—”ë“œ ê°œë°œìì™€ì˜ í˜‘ì—… ì‹œ ì£¼ìš”í•œ ë„êµ¬ë¡œ ì‚¬ìš©ëœë‹¤.
- APIì˜ method, endpointë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤.
- endpointë§ˆë‹¤ ì¸ì¦ ë°©ì‹, content type ë“± ì •ì˜í•  ìˆ˜ ìˆë‹¤.
- body data, query string, path variable ë“± ì •ì˜í•  ìˆ˜ ìˆë‹¤.
- ìš”ì²­, ì‘ë‹µ ë°ì´í„° í˜•ì‹ê³¼ íƒ€ì… ì •ì˜ - data model í™œìš©(schema)

## ğŸ“ CORS(Cross-Origin Resource Sharing)

- ë¸Œë¼ìš°ì €ëŠ” ëª¨ë“  ìš”ì²­ ì‹œ Origin í—¤ë”ë¥¼ í¬í•¨í•œë‹¤.
- ì„œë²„ëŠ” Origin í—¤ë”ë¥¼ ë³´ê³ , í•´ë‹¹ ìš”ì²­ì´ ì›í•˜ëŠ” ë„ë©”ì¸ì—ì„œë¶€í„° ì¶œë°œí•œ ê²ƒì¸ì§€ë¥¼ íŒë‹¨í•œë‹¤.
- ë‹¤ë¥¸ Originì—ì„œ ì˜¨ ìš”ì²­ì€ ì„œë²„ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ê±°ë¶€í•œë‹¤.
- ê·¸ëŸ¬ë‚˜, ë³´í†µ ì„œë²„ì˜ endpointì™€ í™ˆí˜ì´ì§€ domainì€ ë‹¤ë¥¸ ê²½ìš°ê°€ ë§ìŒ.
- ë”°ë¼ì„œ ì„œë²„ì—ì„œëŠ” í™ˆí˜ì´ì§€ domainì„ í—ˆìš©í•˜ì—¬, ë‹¤ë¥¸ domainì´ë¼ í•˜ë”ë¼ë„ ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆê²Œ í•œë‹¤.
- ì„œë²„ëŠ” Access-Control-Allow-Origin ì™¸ì— Access-Control-\* ì„ í¬í•¨í•˜ëŠ” í—¤ë”ì— CORS ê´€ë ¨ ì •ë³´ë¥¼ í´ë¼ì´ì–¸íŠ¸ë¡œ ë³´ë‚¸ë‹¤.
  - ë¸Œë¼ìš°ì €ëŠ” ë‹¤ë¥¸ Originì˜ ì„œë²„ì— ëŒ€í•´ Access-Control-\* í—¤ë”ë¥¼ ìš”êµ¬í•˜ê³ , ì„œë²„ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í•´ë‹¹ í—¤ë”ë¥¼ ë³´ë‚´ì§€ ì•ŠëŠ”ë‹¤. í—ˆìš©í•˜ë ¤ë©´ ë³„ë„ë¡œ cors ì„¤ì •ì„ í•´ì£¼ì–´ì•¼ í•œë‹¤.
- ì›¹ì‚¬ì´íŠ¸ì— ì•…ì„± scriptê°€ ë¡œë“œë˜ì–´, ìˆ˜ìƒí•œ ìš”ì²­ì„ í•˜ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•¨ì´ë‹¤.
- ë°˜ëŒ€ë¡œ, ìµëª… ìœ ì €ë¡œë¶€í„°ì˜ DDos ê³µê²© ë“±ì„ ë§‰ê¸° ìœ„í•¨ì´ë‹¤.
- ì„œë²„ì— ì§ì ‘ CORS ì„¤ì •ì„ í•  ìˆ˜ ì—†ë‹¤ë©´, Proxy ì„œë²„ ë“±ì„ ë§Œë“¤ì–´ í•´ê²°í•œë‹¤.

## ğŸ“ ë¦¬ì•¡íŠ¸ì—ì„œ API ì‚¬ìš© ë°©ë²•

```jsx
useEffect(() => {
  async function fetchUser() {
    // try ~ catchë¥¼ ì´ìš©í•´ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í•˜ì„¸ìš”.
    try {
      const response = await axios.get(
        "<https://jsonplaceholder.typicode.com/error>"
      );
      setUsers(response.data);
    } catch (e) {
      setError(e);
    }
  }
  fetchUser();
}, []);
```

## ğŸ“ axios cancelToken

```jsx
useEffect(() => {
  setLoading(true);
  let cancel;

  axios
    .get(currentPageUrl, {
      cancelToken: new axios.CancelToken((c) => (cancel = c)),
    })
    .then((res) => {
      setLoading(false);
      setNextPageUrl(res.data.next);
      setPrevPageUrl(res.data.previous);
      setPokemon(res.data.results.map((p) => p.name));
    });

  return () => cancel();
}, [currentPageUrl]);
```

- `axios.get()`ì— `{ cancelToken: new axios.CancelToken(c => cancel = c) }`ì„ í•¨ê»˜ ë„˜ê²¨ì¤Œìœ¼ë¡œì¨ í˜ì´ì§€ì— ëŒ€í•œ ì •ë³´ê°€ ë°”ë€ŒëŠ” ê²ƒì„ ì •ë¦¬í•  ìˆ˜ ìˆë‹¤.
- cancelTokenì€ Axiosì—ì„œ ì œê³µí•˜ëŠ” ê²ƒìœ¼ë¡œ API ìš”ì²­ì„ ì·¨ì†Œí•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” í† í°ì´ë‹¤.

## ğŸ“useReducerë¡œ API ë‹¤ë£¨ê¸°

```jsx
import React, { useEffect, useReducer } from "react";
import axios from "axios";

function reducer(state, action) {
  switch (action.type) {
    case "LOADING":
      return {
        loading: true,
        data: [],
        error: null,
      };
    case "SUCCESS":
      return {
        loading: false,
        data: action.data,
        error: null,
      };
    case "FAIL":
      return {
        loading: false,
        data: [],
        error: action.error,
      };
    default:
      throw new Error();
  }
}

function Users() {
  const [state, dispatch] = useReducer(reducer, {
    loading: false,
    data: [],
    error: null,
  });

  async function fetchUser() {
    try {
      dispatch({ type: "LOADING" });
      const response = await axios.get(
        "<https://jsonplaceholder.typicode.com/users>"
      );
      dispatch({ type: "SUCCESS", data: response.data });
    } catch (e) {
      dispatch({ type: "FAIL", error: e });
    }
  }

  useEffect(() => {
    fetchUser();
  }, []);

  const { loading, data, error } = state;

  if (loading) return <h4>ë¡œë”©ì¤‘...</h4>;
  if (error) return <h4>ì—ëŸ¬ ë°œìƒ!</h4>;

  const userName = data.map((user) => <li key={user.id}> {user.name} </li>);

  return (
    <>
      <h4>ì‚¬ìš©ì ë¦¬ìŠ¤íŠ¸</h4>
      <div> {userName} </div>
      <button onClick={fetchUser}>ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
    </>
  );
}

export default Users;
```

## ğŸ’¡ ì˜¤ëŠ˜ ê¹¨ë‹¬ì€ ê²ƒ

- async/await - Promiseë¥¼ í†µí•´ parallelismì„ êµ¬í˜„í•˜ëŠ” ì½”ë“œëŠ” ì°¸ì‹ í–ˆë‹¤. ì•„ì´ë””ì–´ê°€ ì°¸ ì¢‹ë‹¤....!

## ğŸ“Œ ì°¸ê³ 

- [Cancellation](https://axios-http.com/docs/cancellation)
